# DFO Party Management System - TODO

## 🚀 완료된 작업

### ✅ 프론트엔드 UI 개선
- [x] 캐릭터 카드 디자인 개선 (서버-레벨-이름 순서)
- [x] "남은 숙제" 타이틀 추가
- [x] 던전 클리어 상태 O/X 표시 (클리어: O, 미클리어: X)
- [x] 직업별 스탯 표시 (버퍼: 버프력, 딜러: 총딜)
- [x] 연필 버튼으로 수동 입력 기능
- [x] Neople API 링크 푸터 추가
- [x] 주황색 레벨 표시 제거
- [x] 던전 클리어 상태 색상 수정 (클리어: 초록색, 미클리어: 빨간색)
- [x] **던전별 제한 표시**: 나벨 하드(4명), 황혼전(8명), 안개신/베누스(20명)
- [x] **나벨 클리어 분리**: 일반/하드 모드별 클리어 현황 표시
- [x] **황혼전 컬럼 추가**: 던전 클리어 현황 테이블에 황혼전 컬럼 추가

### ✅ 백엔드 기능 개선
- [x] 모험단 정보 자동 DB 저장
- [x] 캐릭터-모험단 관계 설정
- [x] JobType 엔티티 및 Repository 추가
- [x] 직업별 버퍼/딜러 구분 로직 DB 기반으로 개선
- [x] 캐릭터 검색 시 모험단 정보 자동 조회
- [x] **던전 클리어 자동 초기화**: 매주 목요일 오전 8시 스케줄링
- [x] **황혼전 적격성 체크**: 명성 72,688, 버퍼 버프력 5,200,000, 딜러 총딜 12,000,000,000
- [x] **목요일 API 제한 시간 조정**: 8:00 ~ 10:00 (기존 8:45 ~ 18:00)
- [x] **isBuffer 메소드 통합**: CharacterUtils 클래스로 중앙화
- [x] **JobType 동기화 서비스**: DFO API에서 직업 정보 자동 수집 및 버퍼/딜러 구분

### ✅ 데이터베이스 스키마
- [x] Adventure 엔티티 분리
- [x] Character-Adventure ManyToOne 관계 설정
- [x] JobType 테이블 생성 및 초기 데이터 입력
- [x] **Twilight 적격성 필드 추가**: Character 엔티티에 isTwilightEligible 필드 추가
- [x] **mock_api_data 테이블 정리**: 사용하지 않는 테이블로 제거 예정

### ✅ API 호출 일관성 개선
- [x] **프론트엔드 API 통합**: 모든 Vue 컴포넌트에서 apiFetch 사용으로 통일
- [x] **DungeonStatus.vue**: apiFetch import 추가 및 "Refresh All" 오류 수정
- [x] **CharacterSearch.vue**: isBuffer import 통합
- [x] **CharacterDetail.vue**: isBuffer import 통합
- [x] **PartyFormation.vue**: isBuffer import 통합
- [x] **AdvancedPartyBuilder.vue**: apiFetch 사용으로 통일
- [x] **AdvancedPartyOptimization.vue**: apiFetch 사용으로 통일
- [x] **PartyModification.vue**: apiFetch 사용으로 통일

### ✅ 코드 리팩토링
- [x] **CharacterUtils 통합**: 프론트엔드와 백엔드에 각각 utils 폴더 생성
- [x] **isBuffer 로직 중앙화**: 모든 isBuffer 메소드를 CharacterUtils로 통합
- [x] **Nabel 적격성 로직 이동**: Character 엔티티에서 CharacterService로 이동
- [x] **나벨 버퍼 버프력 기준 수정**: 천만 단위에서 백만 단위로 수정 (하드: 5,000,000, 일반: 4,000,000)

## 🔄 진행 중인 작업

### 📱 캐릭터 상세 정보 페이지 개발
- [x] CharacterDetail.vue 페이지 생성
- [x] 라우터 설정 추가
- [x] 캐릭터 카드 클릭 시 상세 페이지 이동
- [ ] 상세 페이지에서 스탯 수정 기능 구현
- [ ] 상세 페이지에서 즐겨찾기 설정 기능 구현

## 📋 예정된 작업

### 🎯 우선순위 높음
- [ ] **Linter 오류 수정**: TypeScript 타입 오류 및 Vue 템플릿 오류 해결
- [ ] **Character 인터페이스 업데이트**: dungeonClearNabelNormal, dungeonClearNabelHard 필드 추가
- [ ] **Twilight 적격성 기준 조정**: 하드 나벨과 동일한 기준으로 수정 (버퍼: 5,000,000, 딜러: 10,000,000,000)
- [ ] **mock_api_data 테이블 제거**: 사용하지 않는 테이블 정리
- [ ] **JobType 테이블 초기화**: DFO API에서 직업 정보 자동 수집 및 저장

### 🎯 우선순위 중간
- [ ] **던전 클리어 상태 실시간 업데이트**: SSE를 통한 실시간 던전 클리어 상태 동기화
- [ ] **캐릭터 이미지 표시**: DFO API에서 제공하는 캐릭터 이미지 표시
- [ ] **검색 결과 페이지네이션**: 대량 검색 결과에 대한 페이지네이션 구현
- [ ] **캐릭터 검색 히스토리**: 최근 검색 기록 저장 및 표시

### 🎯 우선순위 낮음
- [ ] **캐릭터 비교 기능**: 두 캐릭터의 스탯 비교 기능
- [ ] **파티 최적화 알고리즘 개선**: 더 정교한 파티 구성 알고리즘
- [ ] **던전별 파티 추천 시스템**: 던전별 최적 파티 구성 자동 추천
- [ ] **모바일 반응형 디자인 개선**: 모바일 환경 최적화

## 🐛 알려진 이슈

### 🔴 심각한 이슈
- **TypeScript 타입 오류**: Character 인터페이스에 dungeonClearNabelNormal, dungeonClearNabelHard 필드 누락
- **Vue 템플릿 오류**: 일부 컴포넌트에서 타입 안전성 문제
- **Java 컴파일 오류**: 일부 백엔드 파일에서 import 및 Lombok 관련 오류

### 🟡 주의가 필요한 이슈
- **모험단 정보 표시**: 일부 경우 "모험단 정보 없음"으로 표시 (DFO API 응답 확인 필요)
- **직업 표시 문제**: "귀검사(여) (베가본드)" 형태로 표시되는데, 괄호 안의 직업명만 표시되도록 수정 필요
- **MariaDB 연결 경고**: 인증되지 않은 연결 시도로 인한 경고 로그 발생
- **Twilight 적격성 기준**: 현재 구현된 기준과 사용자 요청 기준이 다름 (수정 필요)

### 🟢 경미한 이슈
- **캐릭터 카드 하단 중복 정보**: 일부 정보가 중복으로 표시
- **UI 반응성**: 일부 UI 요소의 반응성 개선 필요
- **로깅 메시지**: "동기화 제한 확인" 로그가 여전히 일부 남아있음

## 📝 기술적 개선사항

### 🔧 백엔드
- [x] **SSE 연결 안정성 개선**: ClientAbortException 처리 및 재연결 로직 구현
- [x] **SSE 예외 처리기 구현**: Content-Type 'text/event-stream' 전용 예외 처리
- [x] **데이터베이스 연결 풀 최적화**: 불필요한 연결 시도 방지
- [x] **JVM 메모리 설정 최적화**: Helm 차트에 JAVA_OPTS 추가 (Xms512m, Xmx1g)
- [x] **Playwright 리소스 관리 개선**: PreDestroy 메서드로 브라우저 인스턴스 정리
- [x] **SSE 연결 수 제한**: 클라이언트당 최대 3개, 전체 최대 100개 연결 제한
- [x] **메모리 모니터링 서비스**: 주기적 메모리 사용량 체크 및 OOM 위험 감지
- [x] **메모리 상태 API**: 실시간 메모리 상태 확인 및 수동 GC 실행 엔드포인트
- [ ] **캐릭터 검색 성능 최적화**: 대량 데이터 처리 시 성능 개선
- [ ] **에러 핸들링 개선**: 더 상세한 에러 메시지 및 로깅
- [ ] **로깅 시스템 개선**: 구조화된 로깅 및 로그 레벨 관리

### 🔧 프론트엔드
- [x] **상태 관리 최적화**: Pinia 스토어 활용
- [x] **컴포넌트 재사용성 개선**: 공통 컴포넌트 분리
- [x] **타입 안정성 강화**: TypeScript 타입 정의 개선
- [ ] **테스트 코드 작성**: 단위 테스트 및 통합 테스트
- [ ] **에러 바운더리**: 컴포넌트 레벨 에러 처리
- [ ] **로딩 상태 관리**: API 호출 시 로딩 인디케이터 개선

## 📊 성능 최적화

### 🚀 데이터베이스
- [ ] **인덱스 최적화**: 쿼리 성능 향상을 위한 인덱스 추가
- [ ] **쿼리 성능 개선**: N+1 문제 해결 및 배치 처리
- [ ] **연결 풀 설정 최적화**: MariaDB 연결 풀 설정 조정

### 🚀 API 응답
- [x] **Nginx 타임아웃 설정 최적화**: SSE 연결을 위한 upstream 타임아웃 값 조정
- [x] **백엔드 응답 시간 최적화**: SSE 연결 시 응답 지연 문제 해결
- [ ] **응답 압축**: gzip 압축을 통한 전송 데이터 크기 감소
- [ ] **CDN 활용**: 정적 리소스에 대한 CDN 적용 검토

## 🔒 보안 및 권한

### 🛡️ 인증/인가
- [ ] **사용자 로그인 시스템**: 기본적인 사용자 인증 시스템
- [ ] **권한 관리 시스템**: 관리자/일반 사용자 권한 구분
- [ ] **API 키 관리**: DFO API 키 보안 관리

### 🛡️ 데이터 보호
- [ ] **개인정보 암호화**: 민감한 정보 암호화 저장
- [ ] **API 요청 제한**: Rate limiting 및 DDoS 방어
- [ ] **로그 보안**: 민감한 정보가 포함된 로그 필터링

## 📱 사용자 경험

### 🎨 UI/UX
- [x] **다크 모드 지원**: ThemeToggle 컴포넌트로 테마 전환
- [ ] **키보드 단축키 지원**: 주요 기능에 대한 키보드 단축키
- [x] **접근성 개선**: AccessibilityHelper 컴포넌트로 접근성 향상
- [ ] **다국어 지원**: 한국어/영어 다국어 지원

### 📱 반응형 디자인
- [x] **모바일 최적화**: 기본적인 반응형 디자인 적용
- [ ] **태블릿 지원**: 태블릿 환경 최적화
- [ ] **다양한 화면 크기 대응**: 더 세밀한 반응형 디자인

## 🧪 테스트 및 품질

### 🧪 테스트
- [ ] **단위 테스트 작성**: 백엔드 서비스 및 프론트엔드 컴포넌트 테스트
- [ ] **통합 테스트 작성**: API 엔드포인트 통합 테스트
- [ ] **E2E 테스트 작성**: 사용자 시나리오 기반 테스트
- [ ] **성능 테스트**: 부하 테스트 및 성능 병목 지점 파악

### 📊 모니터링
- [x] **애플리케이션 성능 모니터링**: 메모리 사용량 및 GC 모니터링
- [x] **에러 추적 시스템**: 백엔드 에러 로깅 및 모니터링
- [ ] **사용자 행동 분석**: 사용자 사용 패턴 분석
- [x] **서버 리소스 모니터링**: CPU, 메모리, 디스크 사용량 모니터링

## 🔄 최근 완료된 주요 작업

### 2024년 12월 19일
- [x] **던전 클리어 현황 UI 개선**: 던전별 제한 표시, 나벨 일반/하드 분리
- [x] **황혼전 던전 추가**: 던전 클리어 현황에 황혼전 컬럼 추가
- [x] **API 호출 일관성 개선**: 모든 프론트엔드 컴포넌트에서 apiFetch 사용
- [x] **목요일 API 제한 시간 조정**: 8:00 ~ 10:00로 변경
- [x] **황혼전 적격성 체크**: 명성 및 스탯 기준으로 적격성 판단
- [x] **isBuffer 메소드 통합**: CharacterUtils 클래스로 중앙화
- [x] **JobType 동기화 서비스**: DFO API에서 직업 정보 자동 수집
- [x] **던전 클리어 자동 초기화**: 매주 목요일 오전 8시 스케줄링
- [x] **나벨 버퍼 버프력 기준 수정**: 천만 단위에서 백만 단위로 수정

## 📋 사용자 요청 기능 리스트

### 🎯 완료된 요청사항
- [x] **던전별 제한 표시**: 나벨 하드(4명), 황혼전(8명), 안개신/베누스(20명)
- [x] **나벨 클리어 분리**: 일반/하드 모드별 클리어 현황 표시
- [x] **"Refresh All" 오류 수정**: apiFetch import 문제 해결
- [x] **황혼전 컬럼 추가**: 던전 클리어 현황 테이블에 황혼전 표시
- [x] **프론트엔드 API 일관성**: 모든 Vue 컴포넌트에서 apiFetch 사용
- [x] **백엔드 로그 정리**: "동기화 제한 확인" 로그 제거
- [x] **목요일 제한 시간 조정**: 8:00 ~ 10:00로 변경
- [x] **황혼전 적격성 체크**: 명성 72,688, 스탯 기준 구현
- [x] **헤카테 버퍼 분류 오류 수정**: isBuffer 로직에 헤카테 추가
- [x] **isBuffer 메소드 통합**: utils 폴더에 중앙화
- [x] **나벨 적격성 로직 확인**: 하드 나벨 체크 로직 유지 확인
- [x] **JobType 테이블 초기화**: DFO API에서 직업 정보 자동 수집
- [x] **테이블 역할 분석**: mock_api_data(제거 예정), shared_parties(유지)
- [x] **나벨 버퍼 버프력 기준 수정**: 천만 단위에서 백만 단위로 수정
- [x] **던전 클리어 자동 초기화**: 매주 목요일 오전 8시 스케줄링

### 🔄 진행 중인 요청사항
- [ ] **Linter 오류 수정**: TypeScript 및 Vue 템플릿 오류 해결
- [ ] **Twilight 적격성 기준 조정**: 하드 나벨과 동일한 기준으로 수정

### 📝 추가 요청사항
- [ ] **성능 최적화**: 대량 데이터 처리 시 성능 개선
- [ ] **에러 처리 개선**: 더 친화적인 에러 메시지 및 복구 방법 제시
- [ ] **사용자 가이드**: 주요 기능 사용법 가이드 작성

---

**마지막 업데이트**: 2024년 12월 19일  
**담당자**: 개발팀  
**상태**: 개발 진행 중 (주요 기능 90% 완료) 